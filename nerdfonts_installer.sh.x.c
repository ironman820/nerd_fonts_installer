#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f nerdfonts_installer.sh -o release/nerdfonts-installer 
#endif

static  char data [] = 
#define      chk2_z	19
#define      chk2	((&data[3]))
	"\032\331\270\262\242\340\102\043\057\326\353\121\261\114\256\320"
	"\373\046\307\310\205\354\114\234\040\041"
#define      tst2_z	19
#define      tst2	((&data[30]))
	"\316\100\277\262\324\300\347\171\352\352\216\350\046\356\215\062"
	"\036\136\270\123\213\161\142\213\174"
#define      chk1_z	22
#define      chk1	((&data[53]))
	"\067\367\300\355\146\161\354\101\044\251\173\321\252\147\034\001"
	"\252\146\365\123\306\161\132\140"
#define      date_z	1
#define      date	((&data[75]))
	"\026"
#define      pswd_z	256
#define      pswd	((&data[88]))
	"\374\053\133\350\105\065\240\222\321\301\264\276\143\274\354\353"
	"\347\346\372\174\205\017\057\127\171\015\225\005\312\101\230\020"
	"\261\226\105\332\043\010\171\335\327\073\260\073\370\235\047\337"
	"\203\042\133\011\061\213\140\252\230\366\260\143\070\111\164\351"
	"\340\272\304\003\302\075\340\232\170\221\326\160\057\376\120\263"
	"\040\254\275\121\067\035\374\320\024\255\064\115\366\250\066\326"
	"\143\372\332\045\070\273\300\261\115\227\042\174\225\162\060\266"
	"\037\355\007\127\013\003\047\037\261\133\154\247\004\243\176\147"
	"\236\130\215\326\024\116\210\141\346\252\336\173\035\017\061\074"
	"\374\071\223\010\075\273\047\356\027\224\226\033\070\024\203\327"
	"\155\021\256\202\140\066\343\106\341\302\302\376\321\363\073\316"
	"\055\316\326\152\212\376\130\241\223\356\275\314\003\100\243\161"
	"\122\121\363\262\207\327\370\150\232\272\147\154\256\242\072\333"
	"\161\021\106\373\020\236\234\243\215\131\157\221\232\023\002\355"
	"\144\366\237\354\316\230\125\151\123\274\325\002\137\020\335\320"
	"\041\043\314\061\302\150\325\120\302\105\341\135\130\344\112\275"
	"\333\351\251\251\202\377\022\325\273\350\327\033\245\033\214\345"
	"\332\077\161\127\315\346\176\005\335\243\120\253\205\203\120\202"
	"\257\253\152\364\340\013\207\262\315\073\160\162\126\375\130\061"
	"\074\311\210\011\257"
#define      msg1_z	65
#define      msg1	((&data[386]))
	"\252\042\315\353\110\372\267\323\056\277\363\374\054\120\044\223"
	"\257\201\275\371\230\204\103\305\023\315\256\342\352\220\355\045"
	"\043\312\003\252\354\273\275\034\227\335\373\332\367\043\277\112"
	"\120\246\246\211\324\313\114\305\161\121\161\261\354\227\370\074"
	"\342\113\137\070\057\342\211\261\222\065\034"
#define      tst1_z	22
#define      tst1	((&data[460]))
	"\235\366\213\307\344\317\131\204\137\151\100\041\034\165\163\111"
	"\354\144\155\250\172\172"
#define      shll_z	10
#define      shll	((&data[484]))
	"\111\071\052\022\165\034\367\007\146\314\234\070\150\237"
#define      inlo_z	3
#define      inlo	((&data[496]))
	"\254\331\302"
#define      lsto_z	1
#define      lsto	((&data[499]))
	"\172"
#define      msg2_z	19
#define      msg2	((&data[501]))
	"\214\254\222\227\305\103\121\146\123\130\020\035\103\107\247\012"
	"\113\117\171\255\311"
#define      xecc_z	15
#define      xecc	((&data[524]))
	"\072\317\213\134\123\073\360\371\174\234\311\246\273\133\223\313"
	"\110\052"
#define      rlax_z	1
#define      rlax	((&data[539]))
	"\300"
#define      opts_z	3
#define      opts	((&data[540]))
	"\365\117\254"
#define      text_z	4253
#define      text	((&data[1566]))
	"\047\077\330\220\337\017\121\260\202\335\011\377\030\152\214\341"
	"\165\170\343\257\107\156\233\250\057\244\220\006\325\207\245\374"
	"\306\176\214\246\215\336\126\017\273\140\017\324\312\233\265\077"
	"\024\231\357\133\010\212\004\067\056\225\075\003\034\343\377\343"
	"\141\214\211\356\152\337\376\045\100\016\372\012\251\257\112\275"
	"\111\071\031\121\304\035\211\362\263\307\366\317\252\366\262\013"
	"\202\074\371\355\033\370\023\134\006\015\146\260\275\261\156\006"
	"\352\207\130\256\245\341\241\130\250\230\050\123\216\332\136\021"
	"\027\130\376\062\120\022\216\127\037\365\007\334\247\165\343\221"
	"\374\073\100\242\035\342\373\306\172\043\031\011\376\170\033\025"
	"\320\031\110\041\054\327\170\113\314\200\050\163\365\014\005\362"
	"\110\106\224\145\051\217\054\243\263\105\255\261\276\310\306\216"
	"\342\016\260\016\345\051\132\262\251\203\046\237\217\054\221\327"
	"\162\046\075\234\266\151\100\151\257\355\032\155\265\340\374\230"
	"\357\254\246\325\326\001\207\200\204\256\037\024\332\261\354\115"
	"\327\051\351\215\222\051\366\102\027\021\257\315\362\253\145\341"
	"\130\014\267\057\015\077\257\222\355\317\247\310\200\223\026\127"
	"\274\377\345\117\051\334\222\101\355\101\016\340\355\163\301\106"
	"\200\171\165\215\270\045\040\245\364\307\156\165\132\204\314\027"
	"\204\262\147\255\216\371\357\174\073\375\134\050\161\036\157\361"
	"\227\345\177\117\012\237\365\377\147\143\164\302\347\101\331\153"
	"\364\101\031\202\072\010\376\166\006\132\236\167\170\016\150\020"
	"\363\350\137\376\207\124\376\357\267\163\261\236\264\213\012\250"
	"\314\043\053\007\053\052\175\061\204\034\251\375\052\022\015\035"
	"\372\155\034\202\301\032\161\171\215\042\027\101\256\042\352\172"
	"\105\026\201\161\100\377\243\305\033\114\303\105\136\320\143\131"
	"\075\177\333\377\231\114\170\046\157\220\150\035\262\123\230\370"
	"\152\032\151\252\031\014\160\064\131\063\172\270\003\336\021\101"
	"\136\354\101\370\071\271\037\251\112\207\306\374\333\137\364\106"
	"\171\136\360\222\153\140\307\305\224\102\175\230\041\217\331\177"
	"\174\032\167\265\324\226\136\036\036\045\033\372\205\020\100\376"
	"\156\061\220\332\222\130\237\046\232\035\276\274\254\230\073\050"
	"\262\263\336\207\111\075\246\150\142\301\142\350\322\243\346\101"
	"\324\167\033\146\317\272\214\152\327\112\046\204\343\142\254\225"
	"\025\212\035\137\307\303\307\052\205\052\022\127\316\370\230\242"
	"\160\263\010\077\156\225\252\106\340\321\312\303\063\167\131\111"
	"\002\166\250\311\072\160\364\277\233\007\027\151\377\257\013\160"
	"\143\024\257\321\251\132\030\212\053\343\115\137\132\247\250\135"
	"\036\120\046\130\301\033\030\134\042\057\306\042\337\321\222\102"
	"\346\102\024\220\234\054\032\310\020\150\047\153\017\317\310\055"
	"\040\357\206\342\012\236\076\054\316\004\116\255\326\341\357\275"
	"\043\004\115\277\060\147\210\101\317\257\254\337\177\165\015\240"
	"\144\223\202\156\062\300\233\001\305\351\256\234\313\236\131\356"
	"\242\246\256\323\016\066\024\336\346\301\275\145\066\313\005\232"
	"\137\207\011\222\110\244\223\016\216\101\252\131\337\004\107\202"
	"\252\365\125\271\053\152\227\022\053\125\167\141\040\174\374\200"
	"\004\005\022\114\251\245\133\067\347\005\220\307\012\330\111\265"
	"\315\236\156\371\011\005\013\064\133\203\226\174\000\222\374\004"
	"\227\016\121\100\264\254\170\233\262\010\142\274\340\253\161\256"
	"\112\337\250\123\345\263\210\101\066\036\275\066\260\272\073\107"
	"\311\214\210\175\071\001\031\353\012\173\250\352\047\031\231\162"
	"\371\101\305\337\365\116\040\054\154\336\143\034\230\236\144\142"
	"\053\355\340\145\356\371\121\370\164\371\343\234\023\175\016\014"
	"\276\324\354\264\042\015\341\216\353\104\253\204\343\020\347\017"
	"\375\307\164\354\300\305\344\065\277\310\321\322\105\340\337\004"
	"\265\314\270\327\331\231\146\304\336\021\111\301\042\060\321\037"
	"\367\106\014\270\014\361\355\313\271\277\236\377\240\176\003\125"
	"\112\274\055\043\126\223\350\064\245\062\366\307\143\310\347\132"
	"\016\364\023\032\345\001\346\236\300\204\236\141\002\241\266\115"
	"\135\343\161\264\167\131\350\035\214\337\345\357\247\314\112\266"
	"\301\135\320\246\136\266\105\037\073\343\200\076\204\067\213\342"
	"\033\374\226\223\126\177\260\343\137\225\322\007\142\034\275\043"
	"\171\215\311\330\104\016\367\200\362\170\276\167\260\112\131\313"
	"\107\360\136\236\160\017\201\320\244\123\327\006\160\224\052\024"
	"\306\011\230\202\135\057\231\162\322\033\004\073\061\255\146\321"
	"\023\261\117\142\070\346\024\311\364\003\013\350\112\343\165\363"
	"\147\220\106\241\313\343\115\073\337\166\213\360\044\367\331\244"
	"\301\272\014\112\234\245\052\031\303\166\240\144\172\155\315\310"
	"\150\352\177\054\261\254\131\320\121\161\111\234\177\126\331\230"
	"\161\343\354\330\033\215\216\254\010\304\036\160\251\070\300\160"
	"\252\173\341\220\144\137\372\065\066\321\012\061\301\115\200\103"
	"\352\220\112\157\233\344\024\302\352\223\042\070\116\204\344\235"
	"\170\143\133\353\333\265\306\201\153\353\227\323\267\271\311\324"
	"\361\115\360\141\227\367\005\007\077\340\357\063\047\334\316\143"
	"\034\353\313\226\344\302\336\062\160\055\235\340\031\237\155\214"
	"\360\343\111\166\003\261\367\203\066\036\063\162\310\021\053\235"
	"\310\125\031\255\224\124\174\124\161\207\077\054\172\274\105\126"
	"\261\134\015\262\075\075\307\056\345\034\241\316\343\003\376\364"
	"\006\114\141\002\147\010\332\207\131\313\023\126\305\223\032\247"
	"\323\030\012\270\202\277\242\131\267\110\156\003\367\325\261\200"
	"\270\216\121\053\274\141\037\345\271\367\377\335\112\250\352\233"
	"\311\072\151\053\107\231\137\345\013\252\371\130\101\054\055\116"
	"\227\320\045\074\154\127\106\161\200\303\263\203\341\154\116\105"
	"\031\224\327\010\043\041\146\334\242\372\020\216\073\102\325\051"
	"\243\165\323\132\061\317\131\351\125\162\041\020\010\007\333\153"
	"\210\327\165\033\144\331\075\042\322\142\306\233\262\247\104\002"
	"\166\224\305\314\170\232\274\370\111\027\057\144\357\030\024\205"
	"\026\115\306\127\035\302\306\054\270\271\346\357\175\347\176\241"
	"\135\132\315\114\102\053\137\057\025\157\306\303\021\324\016\041"
	"\227\151\362\211\274\275\340\075\315\140\343\244\342\302\350\244"
	"\270\262\240\073\003\226\265\313\350\015\006\133\272\343\232\326"
	"\127\171\331\337\046\213\155\313\075\177\144\336\111\330\025\153"
	"\010\007\207\354\063\234\353\117\324\352\126\142\255\211\171\042"
	"\166\062\033\207\161\053\063\120\007\356\121\145\257\032\032\022"
	"\102\252\361\207\003\007\205\176\165\055\333\353\312\127\257\130"
	"\162\245\254\024\326\235\001\273\031\103\247\202\237\336\003\221"
	"\215\341\363\271\011\112\103\154\022\016\341\162\015\026\010\123"
	"\366\145\110\262\000\112\041\324\042\207\374\214\317\260\322\334"
	"\334\275\102\050\112\154\373\307\257\037\013\245\335\127\117\156"
	"\333\060\245\371\305\271\201\102\066\073\224\050\211\154\163\027"
	"\343\133\041\114\066\033\316\376\275\267\271\357\261\020\323\224"
	"\344\272\257\153\013\113\355\226\153\335\220\024\176\070\052\242"
	"\366\263\335\035\256\034\272\037\247\126\040\235\011\374\226\266"
	"\326\313\143\021\054\167\130\377\134\377\024\027\302\370\212\173"
	"\331\177\124\365\172\377\144\266\066\046\301\147\150\022\376\205"
	"\160\016\116\307\377\125\272\061\173\167\043\226\131\140\262\115"
	"\104\054\215\076\034\134\342\354\213\321\373\354\110\231\374\001"
	"\144\374\375\250\344\212\003\375\006\210\046\224\014\060\073\005"
	"\171\221\156\046\320\257\266\225\177\100\006\031\336\065\002\105"
	"\252\331\366\263\112\346\020\117\275\270\310\117\173\164\373\361"
	"\222\273\115\145\040\032\075\024\120\173\124\312\143\062\300\116"
	"\160\364\211\142\010\002\101\001\145\003\237\162\171\006\327\267"
	"\357\000\367\277\107\343\252\316\142\077\155\364\173\200\340\144"
	"\233\164\275\136\314\016\312\345\247\146\044\041\363\175\057\134"
	"\342\103\374\356\210\023\133\342\011\224\010\131\123\315\255\332"
	"\311\156\111\256\224\362\350\341\143\350\356\015\065\271\233\331"
	"\134\044\070\331\340\152\176\345\027\155\037\003\023\034\005\262"
	"\110\023\344\066\004\004\064\366\352\351\077\376\044\367\346\010"
	"\251\341\260\041\103\362\130\230\203\372\316\251\311\317\050\007"
	"\203\262\357\205\012\055\050\164\361\123\353\275\352\245\321\107"
	"\012\341\053\374\262\101\102\124\346\011\115\063\144\200\255\150"
	"\120\012\103\167\363\211\216\170\174\115\326\036\031\234\257\333"
	"\222\227\257\233\106\065\110\276\362\243\343\342\007\236\316\071"
	"\204\172\057\007\210\305\266\352\214\221\357\136\303\263\355\144"
	"\262\174\343\205\377\262\066\161\166\067\047\076\167\157\375\040"
	"\044\051\366\351\014\024\221\126\365\155\333\201\371\230\312\316"
	"\027\254\366\171\215\303\365\361\065\072\240\104\142\201\337\303"
	"\175\054\313\003\233\257\151\227\220\334\363\205\311\045\165\063"
	"\333\233\315\224\244\207\271\257\164\126\202\150\313\161\235\237"
	"\162\053\374\230\216\257\366\115\222\307\145\023\304\116\022\372"
	"\042\316\255\110\135\130\032\027\001\323\325\074\203\224\215\067"
	"\222\217\256\027\254\243\370\126\243\126\124\044\032\333\207\332"
	"\061\004\204\204\134\164\176\335\367\105\116\370\226\332\074\352"
	"\317\157\144\141\016\154\130\033\105\071\251\234\321\362\274\151"
	"\142\230\271\074\000\045\121\343\173\377\157\256\074\230\224\374"
	"\340\120\300\314\150\161\371\201\050\326\125\367\010\217\337\213"
	"\135\267\166\024\174\122\126\172\070\344\364\266\256\363\367\070"
	"\054\323\361\372\002\314\241\201\061\136\361\072\125\272\226\332"
	"\135\201\355\031\347\143\355\352\026\042\220\032\334\202\175\252"
	"\142\234\070\323\234\336\174\164\354\013\173\101\203\376\275\255"
	"\336\126\202\011\027\025\147\063\045\034\346\350\367\250\100\010"
	"\305\272\353\174\252\205\117\365\327\212\362\237\057\105\271\040"
	"\134\244\157\347\122\030\031\022\073\166\250\317\362\161\224\211"
	"\323\045\325\320\226\223\316\116\006\322\333\213\064\235\270\304"
	"\270\022\200\070\234\255\073\036\207\124\023\036\055\351\006\136"
	"\301\116\155\315\336\314\107\242\360\172\323\053\230\162\167\342"
	"\367\024\344\303\177\226\233\115\141\122\371\207\062\065\037\244"
	"\225\102\234\174\061\176\132\011\373\156\074\010\165\253\355\273"
	"\147\376\323\340\044\232\067\275\262\311\274\055\066\214\257\034"
	"\166\035\122\042\017\361\243\261\352\260\126\127\077\314\375\073"
	"\123\130\264\052\021\211\301\262\077\221\102\125\323\375\007\167"
	"\324\037\116\165\373\355\170\273\246\234\171\265\316\157\152\047"
	"\003\346\171\302\206\125\161\111\347\310\035\136\376\137\234\267"
	"\361\345\023\152\207\140\057\356\033\375\267\323\235\047\141\324"
	"\075\262\155\203\251\027\045\350\111\135\005\331\206\216\155\247"
	"\075\162\270\216\175\230\073\230\263\011\127\007\127\143\373\367"
	"\060\324\223\110\372\203\012\145\306\305\321\307\057\345\252\215"
	"\143\157\047\145\103\356\307\063\204\201\043\141\045\265\010\243"
	"\325\202\265\143\302\065\161\235\231\135\240\147\270\104\234\307"
	"\152\117\303\336\162\036\233\153\020\204\172\171\205\010\113\002"
	"\012\260\330\275\107\116\251\364\230\150\300\031\343\061\355\006"
	"\045\133\263\157\136\357\301\004\255\137\160\337\032\275\342\260"
	"\160\075\256\354\323\171\361\147\353\074\201\102\343\352\135\073"
	"\233\245\332\264\333\245\124\227\346\255\154\061\254\217\131\120"
	"\277\120\356\312\052\372\322\254\104\006\356\331\155\360\313\322"
	"\204\320\157\257\327\262\010\150\236\261\265\304\161\156\375\215"
	"\267\263\227\173\252\352\355\231\370\037\366\366\074\006\302\146"
	"\353\014\143\303\374\163\227\240\137\026\355\331\311\306\223\163"
	"\151\337\314\271\141\155\331\372\040\250\146\011\152\343\005\335"
	"\057\213\251\012\220\247\040\311\335\311\212\027\005\315\240\271"
	"\035\126\110\306\231\263\213\356\163\204\351\300\257\216\045\220"
	"\214\364\033\034\016\261\032\106\207\363\145\312\274\324\317\137"
	"\156\240\301\365\336\154\324\173\124\060\151\113\373\122\343\326"
	"\067\061\114\351\067\044\351\266\111\060\014\070\265\144\234\244"
	"\072\221\375\034\127\156\264\101\320\335\175\047\201\266\312\346"
	"\316\371\221\142\031\114\123\275\305\335\111\313\300\344\146\264"
	"\325\120\274\335\031\055\323\260\037\341\226\370\365\114\337\205"
	"\361\303\140\133\211\055\277\132\157\146\252\037\063\210\217\004"
	"\037\007\073\210\354\370\137\366\054\216\375\355\316\207\006\320"
	"\007\136\323\337\374\365\163\274\251\362\177\067\242\153\234\140"
	"\162\262\077\203\276\321\110\122\240\351\304\262\204\037\234\354"
	"\370\203\336\370\326\020\006\133\074\151\320\255\012\030\326\224"
	"\276\147\303\170\321\167\260\255\057\242\306\326\232\054\151\050"
	"\004\075\330\350\131\217\166\222\162\021\011\226\205\334\041\217"
	"\173\347\143\344\270\021\300\114\076\255\244\121\233\242\245\113"
	"\327\373\242\174\017\135\353\177\163\151\023\334\275\017\072\255"
	"\244\030\277\210\207\275\166\232\057\027\264\335\103\135\331\304"
	"\026\225\243\077\373\357\323\002\146\334\225\134\074\272\240\233"
	"\043\101\200\344\213\267\061\134\125\016\044\102\021\105\173\367"
	"\114\352\347\321\170\267\121\166\363\052\046\332\343\277\016\177"
	"\175\167\117\223\323\333\364\000\352\246\330\200\135\301\227\172"
	"\202\100\122\376\103\325\210\337\243\264\346\163\124\206\270\354"
	"\111\331\006\046\022\330\360\006\325\212\314\333\152\231\104\374"
	"\334\351\337\062\316\045\237\262\032\222\174\116\211\104\156\006"
	"\221\040\302\145\210\157\144\202\313\075\242\361\131\156\071\154"
	"\155\234\145\266\004\157\015\113\360\016\346\125\075\112\253\177"
	"\272\271\114\040\374\351\310\225\307\073\342\364\266\074\314\057"
	"\247\366\314\256\121\163\200\115\141\361\164\011\354\003\105\024"
	"\242\313\332\345\355\213\074\023\025\016\050\355\343\250\337\217"
	"\277\272\241\127\313\201\215\342\006\022\234\320\044\102\260\210"
	"\255\010\031\243\353\252\316\330\252\114\213\322\332\051\255\120"
	"\011\235\326\212\217\237\125\337\351\342\045\350\071\074\270\205"
	"\044\151\325\311\042\027\042\304\332\357\034\073\026\223\174\310"
	"\272\063\051\104\014\037\274\150\070\373\272\313\102\251\104\273"
	"\303\037\256\147\335\376\212\326\265\221\212\201\041\320\356\074"
	"\331\253\377\205\260\134\055\207\146\157\120\325\264\072\366\376"
	"\105\241\266\043\027\311\073\042\160\161\130\144\273\065\233\047"
	"\104\020\060\212\127\132\046\345\150\234\043\244\136\064\020\353"
	"\165\144\263\213\200\060\211\312\070\360\213\100\324\172\017\126"
	"\001\341\165\351\211\343\104\102\144\111\020\016\042\355\040\373"
	"\257\011\126\302\366\320\104\023\022\012\231\331\373\143\115\301"
	"\214\147\354\124\364\211\043\026\375\115\124\277\372\240\346\324"
	"\057\234\067\252\045\372\244\023\016\236\071\046\164\066\301\205"
	"\220\046\313\213\262\327\045\220\307\373\127\051\036\243\272\015"
	"\216\277\211\171\330\220\013\226\165\024\270\222\214\165\317\245"
	"\231\002\313\256\054\015\156\147\361\017\242\157\165\114\057\102"
	"\004\253\331\374\071\343\015\152\251\237\336\146\175\117\141\332"
	"\242\367\167\054\167\305\276\015\251\014\225\134\055\343\316\252"
	"\253\210\141\240\150\320\352\347\063\046\177\315\303\253\021\200"
	"\036\240\216\152\342\325\237\062\343\316\262\265\170\334\043\211"
	"\230\105\275\164\245\016\114\250\226\157\174\115\074\324\051\273"
	"\067\044\172\003\357\152\376\031\002\027\261\177\153\216\215\122"
	"\017\067\224\062\156\105\327\271\072\207\020\240\163\263\002\364"
	"\330\345\044\117\052\346\160\127\022\367\136\162\331\060\265\032"
	"\202\265\334\370\162\227\275\237\344\140\035\217\210\127\230\235"
	"\262\115\160\376\263\155\127\027\114\140\006\010\060\240\033\245"
	"\231\250\041\344\070\052\170\117\211\334\003\172\117\053\231\074"
	"\061\246\261\152\047\305\203\220\212\142\144\326\066\347\101\140"
	"\334\345\251\075\242\123\006\120\266\364\004\030\346\352\143\130"
	"\360\347\363\335\043\003\256\277\101\166\035\063\025\035\224\324"
	"\035\130\162\355\014\347\355\036\100\127\174\222\305\213\253\347"
	"\261\337\156\324\244\063\326\334\334\367\256\115\125\136\035\211"
	"\037\365\332\307\112\237\046\362\077\002\127\335\141\001\254\211"
	"\055\007\262\305\175\206\344\255\217\270\313\175\056\300\112\011"
	"\143\026\311\005\275\221\062\000\275\021\016\136\072\227\247\126"
	"\304\031\037\255\334\027\054\117\333\124\052\010\364\350\366\377"
	"\301\067\010\376\355\315\017\257\303\132\262\043\144\024\360\107"
	"\157\341\177\221\347\113\136\311\114\011\073\354\050\204\305\060"
	"\144\114\261\233\042\244\235\333\322\360\210\356\326\070\207\002"
	"\005\277\000\275\113\226\231\164\077\257\020\235\230\020\366\256"
	"\023\150\054\054\077\111\350\007\375\340\244\173\231\076\341\235"
	"\044\370\360\202\267\275\171\217\203\077\063\074\101\033\376\335"
	"\137\141\065\051\007\122\302\210\064\166\170\341\115\304\070\274"
	"\261\364\352\221\251\015\076\124\030\211\325\041\120\074\254\126"
	"\342\214\177\106\245\073\013\267\222\014\256\105\366\203\300\224"
	"\115\245\131\270\254\036\253\122\112\253\116\322\240\370\232\147"
	"\017\144\001\337\076\103\125\256\113\030\370\305\311\335\025\360"
	"\041\355\351\075\334\270\263\007\067\056\355\120\004\002\057\221"
	"\162\262\006\014\044\323\075\227\303\351\360\175\040\241\044\377"
	"\210\227\204\234\326\050\353\057\366\167\355\025\001\070\300\231"
	"\231\250\346\071\270\055\237\012\261\015\252\072\205\301\014\124"
	"\114\344\037\106\122\126\137\276\315\046\315\063\157\033\125\214"
	"\236\223\233\021\202\000\273\251\137\153\026\337\173\241\143\023"
	"\222\012\164\324\312\010\271\204\363\300\041\144\060\054\046\061"
	"\247\130\327\105\312\263\212\061\061\051\361\006\307\304\023\305"
	"\066\346\065\207\223\167\115\340\226\223\310\225\015\004\032\014"
	"\252\153\025\200\300\004\226\047\226\233\057\345\054\310\034\344"
	"\322\130\132\161\327\014\010\233\061\076\301\166\333\251\214\241"
	"\256\274\372\144\031\276\111\075\235\036\160\002\251\126\175\077"
	"\171\372\007\277\342\223\372\203\060\225\312\237\356\340\023\177"
	"\206\237\372\220\207\245\130\131\303\077\074\053\014\007\140\147"
	"\327\024\376\046\142\324\224\030\242\152\356\042\315\356\374\150"
	"\304\107\214\250\327\231\143\042\021\057\170\202\203\035\272\145"
	"\066\272\231\377\301\233\006\255\214\033\272\125\344\364\342\056"
	"\225\174\365\150\174\047\151\273\074\125\133\246\067\075\201\013"
	"\346\040\330\251\314\205\140\017\370\235\226\075\106\322\305\320"
	"\313\037\375\315\332\127\174\227\313\355\110\350\053\341\271\326"
	"\044\154\176\046\047\144\260\366\246\015\255\250\120\341\146\134"
	"\322\060\311\305\106\145\130\016\052\231\172\347\160\300\062\147"
	"\364\127\300\200\034\276\226\346\207\306\205\261\070\113\371\276"
	"\022\070\250\266\376\243\023\333\145\206\254\250\144\311\114\116"
	"\001\362\376\364\345\347\175\233\046\226\260\133\176\031\112\073"
	"\011\327\245\225\221\164\243\151\107\324\205\253\326\305\371\214"
	"\336\253\322\175\354\213\105\102\162\162\246\230\375\324\305\342"
	"\037\265\046\044\157\116\200\134\324\113\137\030\335\377\360\255"
	"\371\015\370\350\077\350\206\012\242\135\116\263\342\061\362\000"
	"\174\017\264\344\174\133\311\147\341\200\324\107\216\233\267\217"
	"\005\215\167\327\277\043\041\376\046\005\167\337\057\043\322\113"
	"\311\345\067\306\367\033\006\226\164\357\336\003\030\022\142\074"
	"\223\135\072\247\127\226\265\342\333\102\272\135\044\302\060\357"
	"\013\054\005\377\364\047\245\304\116\212\232\103\157\256\313\151"
	"\123\333\070\167\166\336\263\173\101\067\177\114\044\370\157\164"
	"\174\167\275\047\160\065\254\263\300\056\223\162\174\253\305\261"
	"\357\003\074\376\140\221\037\351\243\067\042\015\310\051\356\323"
	"\165\262\062\212\025\312\063\205\153\142\266\024\325\102\072\037"
	"\343\011\370\102\332\303\050\341\164\341\012\316\260\142\212\005"
	"\011\147\236\173\266\017\051\046\173\001\251\372\072\247\042\117"
	"\243\030\272\220\117\241\246\302\044\157\154\075\105\220\367\150"
	"\377\244\311\033\230\074\134\224\077\337\031\263\001\311\153\121"
	"\026\107\135\311\127\222\322\033\330\370\170\003\154\135\311\031"
	"\010\122\344\102\224\022\317\252\125\103\057\071\325\365\356\136"
	"\336\144\335\117\373\077\056\335\371\137\205\035\322\133\062\305"
	"\275\076\274\361\231\241\030\337\003\061\016\030\062\232\144\367"
	"\213\075\342\220\304\226\225\323\115\055\367\044\310\253\101\027"
	"\341\364\075\021\074\244\051\227\345\063\303\212\253\045\270\325"
	"\175\023\265\177\312\124\273\043\101\070\035\205\165\116\266\106"
	"\364\374\266\351\357\143\345\252\035\372\052\074\317\324\273\311"
	"\007\050\077\015\162\072\241\375\237\367\061\045\330\263\030\331"
	"\343\344\200\307\360\151\023\330\366\037\263\100\371\111\301\230"
	"\167\332\262\113\203\171\344\116\116\345\152\067\072\323\222\305"
	"\012\125\105\302\016\362\166\176\351\344\147\330\203\113\064\014"
	"\060\136\033\101\342\061\140\044\217\237\037\216\047\310\307\275"
	"\260\110\311\331\264\030\040\066\171\107\054\201\370\041\033\335"
	"\106\374\252\021\236\025\001\324\231\231\174\375\006\364\117\246"
	"\114\224\147\301\175\311\072\326\202\056\372\356\256\252\320\157"
	"\273\124\337\016\136\241\205\372\152\121\355\034\124\141\342\005"
	"\242\207\123\342\022\110\025\000\361\132\066\246\004\101\363\040"
	"\312\251\274\345\053\056\337\355\147\244\332\343\254\373\242\107"
	"\042\047\175\363\054\150\046\220\111\325\021\001\176\051\206\364"
	"\363\333\323\200\362\307\014\020\107\030\331\133\001\322\331\140"
	"\200\051\017\352\114\014\237\342\277\143\067\331\010\037\250\110"
	"\161\106\326\037\353\362\226\276\321\206\076\151\213\350\217\357"
	"\267\033\172\232\115\145\056\175\102\134\362\277\104\330\334\140"
	"\163\134\277\134\121\042\117\343\035\152\157\175\361\064\272\330"
	"\173\016\335\161\227\361\307\331\176\200\270\160\303\054\353\133"
	"\272\312\175\016\316\056\013\206\105\367\200\306\210\305\145\215"
	"\113\166\307\265\103\230\217\113\274\103\073\016\107\003\267\226"
	"\013\224\176\233\320\112\007\302\156\224\330\025\233\375\312\264"
	"\111\323\216\002\010\147\343\332\146\056\200\152\371\124\227\120"
	"\367\016\261\170\364\257\354\270\071\351\332\171\047\125\211\021"
	"\353\304\112\224\271\152\047\343\357\337\165\141\277\117\176\347"
	"\301\110\022\007\017\017\145\103\044\341\354\241\057\106\135\205"
	"\166\245\203\165\077\312\253\046\063\277\170\047\026\141\126\276"
	"\060\224\260\326\046\327\063\052\225\306\157\232\267\124\041\152"
	"\131\151\341\043\127\127\234\212\033\015\140\051\370\225\250\353"
	"\255\200\013\021\103\307\334\072\374\303\161\370\301\353\167\251"
	"\355\166\224\257\226\136\121\001\105\305\225\343\066\161\012\126"
	"\045\364\300\104\227\157\312\242\315\117\231\260\013\270\104\117"
	"\016\240\165\270\156\364\367\146\214\075\234\105\335\212\276\260"
	"\017\312\030\107\267\305\335\261\376\370\347\373\352\042\363\302"
	"\147\002\272\347\364\063\246\153\343\361\305\257\070\266\016\327"
	"\047\035\130\367\301\254\316\310\034\143\362\007\205\346\311\355"
	"\351\204\325\336\270\173\112\233\154\017\113\245\306\131\174\355"
	"\167\325\344\070\201\263\001\236\026\364\245\234\333\157\212\304"
	"\363\137\243\254\332\355\110\107\374\223\354\303\355\151\260\144"
	"\076\225\235\300\111\236\136\137\223\004\374\157\163\206\064\147"
	"\346\327\023\300\304\133\010\301\357\365\204\334\136\065\100\235"
	"\313\335\135\024\174\274\164\020\300\160\177\064\367\263\233\335"
	"\213\256\236\117\012\247\021\371\234\226\326\373\313\026\230\226"
	"\364\366\252\161\263\036\201\163\217\001\247\207\265\103\145\101"
	"\362\004\220\374\253\242\366\110\070\314\103\003\343\333\232\330"
	"\322\105\111\205\144\313\370\363\315\240\173\203\343\340\304\325"
	"\345\125\322\221\367\311\331\057\226\034\063\171\367\316\121\312"
	"\023\233\117\167\147\110\153\064\350\347\270\314\310\174\242\255"
	"\321\165\076\311\076\027\371\324\064\054\116\054\373\240\366\017"
	"\073\105\207\243\215\363\330\166\332\220\103\242\014\345\120\336"
	"\132\217\247\231\247\240\155\333\315\273\007\311\133\375\330\227"
	"\103\137\072\320\122\022\107\055\243\212\320\257\157\040\216\312"
	"\257\066\143\127\326\321\062\244\214\071\156\350\067\106\177\172"
	"\246\272\113\371\315\222\046\160\034\366\040\214\027\256\126\306"
	"\344\272\036\273\213\120\140\030\212\316\000\301\024\200\074\273"
	"\073\207\264\010\032\332\170\066\321\231\303\350\107\032\257\053"
	"\324\315\347\140\036\107\170\250\025\171\152\052\371\246\346\064"
	"\056\232\075\110\165\266\177\107\117\103\057\226\135\337\302\061"
	"\254\252\221\313\361\012\163\007\203\336\062\174\205\030\261\263"
	"\263\357\374\050\245\174\157\364\277\237\213\034\176\116\116\053"
	"\370\340\367\352\352\152\362\155\111\044\351\316\075\233\202\360"
	"\212\177\031\057\373\211\044\273\050\260\330\247\376\046\323\367"
	"\006\312\341\360\065\324\135\176\370\107\115\066\342\317\046\155"
	"\117\077\235\112\310\301\006\361\162\336\231\160\004\154\150\013"
	"\067\112\374\155\036\131\354\027\241\071\115\204\011\163\361\130"
	"\263\216\243\173\120\251\155\302\210\006\063\215\163\233\230\253"
	"\345\224\031\004\356\005\033\217\077\150\023\110\333\005\240\216"
	"\223\104\012\344\355\170\247\166\177\333\003\363\166\233\236\134"
	"\060\267\140\036\275\173\256\374\343\301\104\277\306\345\116\132"
	"\051\130\077\027\321\347\215\120\302\220\103\070\054\342\225\135"
	"\232\366\173\127\161\052\124\125\353\231\025\262\176\143\015\250"
	"\274\115\300\215\064\116\336\366\337\041\057\014\004\304\151\237"
	"\272\345\367\054\017\113\202\373\344\230\256\143\373\274\014\270"
	"\011\314\105\075\033\044\063\372\106\143\006\112\047\160\351\342"
	"\125\340\017\145\054\222\140\020\052\017\163\045\313\177\335\324"
	"\114\043"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
